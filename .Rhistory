reichweite)
batteriekapazitaet <- c(50, 70, 60, 80, 90, 65)
reichweite <- c(200, 280, 240, 320, 360, 250)
df_reichweite <- data.frame(batteriekapazitaet,
reichweite)
lm(reichweite~batteriekapazitaet, data = df_reichweite)
modell <- lm(reichweite~batteriekapazitaet, data = df_reichweite)
modell
summary(modell)
-4.490 + 4.041 * 84
df_new <- data.frame(batteriekapazitaet = 84)
predict(modell, df_new)
-4.4898 + 4.0408 * 84
temperaturen <- c(20.1, 21.3, 19.5, 22.6, 23.0, 20.8, 20.2, 19.9, 21.5, 21.0, 22.2, 19.8, 20.7, 21.1, 22.0, 21.4, 19.3, 23.5, 20.5, 22.8)
zufriedenheit <- c(4.8, 4.5, 4.2, 3.9, 3.6, 4.3, 4.1, 3.9, 4.6, 4.4, 4.7, 4.7, 4.2, 4.4, 4.6, 4.5, 4.8, 3.0, 4.1, 4.9)
mean(x)
mean(temperaturen)
median(zufriedenheit)
n <- length(temperaturen)
sqrt(var(temperaturen)*(n-1)/n)
mean(zufriedenheit>=4)
cor(zufriedenheit, temperaturen)
p_wb <- 0.4
0.3*0.6+0.6*0.2
0.3*0.6+0.4*0.2
0.3*0.6/0.26
geschlecht <- c("m", "w", "m", "m", "w", "w", "m", "w", "m",
"w", "d", "w", "m", "w", "m", "w", "m", "d",
"m", "w", "m", "w", "m", "w", "m")
befoerderung <- c("ja", "ja", "nein", "nein", "nein", "ja",
"ja", "nein", "ja", "ja", "nein", "nein",
"ja", "ja", "nein", "nein", "ja", "ja",
"nein", "nein", "ja", "ja", "nein", "nein",
"nein")
kontingenztafel <- table(geschlecht, befoerderung)
chisq.test(kontingenztafel)
daten <- c("Vanille", "Schokolade", "Nuss", "Schokolade", "Vanille", "Nuss", "Schokolade", "Schokolade", "Vanille", "Nuss",
"Schokolade", "Nuss", "Erdbeere", "Vanille", "Vanille", "Schokolade", "Schokolade", "Vanille", "Nuss", "Schokolade",
"Vanille", "Erdbeere", "Vanille", "Schokolade", "Nuss", "Vanille", "Schokolade", "Schokolade", "Erdbeere", "Vanille",
"Nuss", "Vanille", "Vanille", "Nuss", "Schokolade", "Vanille", "Nuss", "Schokolade", "Vanille", "Erdbeere",
"Vanille", "Nuss", "Schokolade", "Nuss", "Erdbeere", "Vanille", "Vanille", "Nuss", "Erdbeere", "Erdbeere")
table(daten)
prop.table(table(daten))
dbinom(6,10,0.4)
dbinom(3,6,0.75)
modulA <- c(1, 2, 4, 1, 5, 1, 2, 4, 3, 1)
modulB <- c(3, 2, 3, 2, 4, 2, 2, 3, 2, 2)
median(modulA)
mean(modulB<=2)
mad(modulA)
cor(modulA, modulB, method = "spearman")
mad(modulA, constant = 1)
pbinom(3,5,0.3)
dbinom(3,5,0.3)
binom.test(x=140,n=200,p=0.7, alternativ = "less")
1-pnorm(70, 70,10)
pnorm(60, 70,10)-pnorm(30, 70,10)
pnorm(85, 70,10)+(1-pnorm(65, 70,10))
pnorm(85, 70,10)+(1-pnorm(55, 70,10))
pnorm(85, 70,10)+(pnorm(55, 70,10))
pnorm(85, 70,10)-(pnorm(55, 70,10))
mean(verkaufszahlen)
median(verkaufszahlen)
verkaufszahlen <- c(320, 600, 400, 450, 250, 280, 320, 480, 520, 300, 350)
erfahrung <- c(4, 10, 7, 7, 1, 2, 8, 8, 2, 4, 3)
mean(verkaufszahlen)
median(verkaufszahlen)
quantile(erfahrung,0.7)
mean(erfahrung<=7)
mean(erfahrung<=6)
quantile(erfahrung,0.727)
mean(erfahrung<=6)
erfahrung[order(erfahrung)]
0.7*11
var(verkaufszahlen)*10/11
sqrt(var(verkaufszahlen)*10/11)
cor(verkaufszahlen, erfahrung,method = "spearman")
zufriedenheit <- c(5, 4, 2, 1, 3, 4, 5, 5, 3, 1,
2, 3, 5, 5, 3, 1, 2, 5, 5, 4,
1, 4, 2, 4, 5, 3, 2, 2, 2, 5)
abteilung <- c("A", "A", "B", "B", "C", "C", "A", "A", "B", "B",
"C", "C", "A", "A", "B", "B", "C", "C", "A", "A",
"B", "B", "C", "C", "A", "A", "B", "B", "C", "C")
kontingenztafel <- table(zufriedenheit, abteilung)
chisq.test(kontingenztafel)
1-pbinom(17,40,0.3)
pbinom(14,40,0.3)
pbinom(10,40,0.3) + (1-pbinom(30,40,0.3))
1-pbinom(54,80,0.7)
pbinom(56,40,0.3)
pbinom(56,80,0.7)
pbinom(60,80,0.7) + (1-pbinom(65,80,0.7))
pbinom(54,80,0.7)
pbinom(53,80,0.7)
meinung <- matrix(c(80, 60, 40, 20,
30, 50, 60, 40,
50, 40, 30, 20,
40, 30, 20, 50), nrow = 4, byrow = TRUE)
colnames(meinung) <- c("Apple", "Samsung", "Huawei", "Sonstige")
rownames(meinung) <- c("Sehr zufrieden", "Zufrieden", "Neutral", "Unzufrieden")
chisq.test(meinung)
meinung
65.649/(3*sum(meinung))
sqrt(65.649/(3*sum(meinung)))
data <- c(9.5, 10.2, 9.8, 9.6, 10.1,
9.9, 10.8, 9.7, 9.8, 10.2,
10.4, 9.6, 10.4, 9.9, 10.1,
9.8, 10.3, 9.3, 10.2, 10.4)
t.test(data, mu = 10, alternative ="greater")
pnorm(40,50,sqrt(64)) + (1-pnorm(60,50,sqrt(64)))
sqrt(64)
1-pnorm(60,50,8)
pnorm(45,50,8) - pnorm(0,50,8)
pnorm(40,50,8) + (1-pnorm(60,50,8))
install.packages("prophet")
library(prophet)
df <- read.csv('https://raw.githubusercontent.com/facebook/prophet/main/examples/example_wp_log_peyton_manning.csv')
m <- prophet(df)
m
plot(m)
future <- make_future_dataframe(m, periods = 365)
tail(future)
# R
forecast <- predict(m, future)
tail(forecast[c('ds', 'yhat', 'yhat_lower', 'yhat_upper')])
plot(m, forecast)
prophet_plot_components(m, forecast)
dyplot.prophet(m, forecast)
install.packages("RMarkdown")
install.packages("rmarkdown")
library(rmarkdown)
install.packages("rticles")
tinytex::reinstall_tinytex(repository = "illinois")
remotes::install_github("simonpcouch/anyflights")
atlflights19 <- anyflights("ATL", 2020)
library(anyflights)
atlflights19 <- anyflights("ATL", 2020)
path = "/Users/michael/Downloads/"
library(readr)
cal <- read_csv(paste0(path, calendar.csv.gz))
path = "/Users/michael/Downloads/"
library(readr)
cal <- read_csv(paste0(path, calendar.csv.gz))
cal <- read_csv(paste0(path, "calendar.csv.gz"))
head(cal)
cal <- select (-adjusted_price)
library(dplyr)
cal <- select(-adjusted_price)
head(cal)
cal <- select(-adjusted_price)
library(dplyr)
cal <- select(-adjusted_price)
cal <- cal %>% select(-adjusted_price)
cal
con2 <- DBI::dbConnect(RPostgres::Postgres(),
host   = "wi-sql.fh-muenster.de",
dbname = "airbnb",
user      = "buecker",
password      = "wh5Vi3oi",
port     = 5432)
install.packages("RPostgres")
library(RPostgres)
con2 <- DBI::dbConnect(RPostgres::Postgres(),
host   = "wi-sql.fh-muenster.de",
dbname = "airbnb",
user      = "buecker",
password      = "wh5Vi3oi",
port     = 5432)
dbWriteTable(con, calendar, cal)
dbWriteTable(con2, calendar, cal)
dbWriteTable(con2, "calendar", cal)
dbDisconnect(con2)
# Erstellen eines Vektors mit den Verspätungen
verspaetungen <- c(10, 20, 5, 10, 30,
25, 5, 5, 10, 20,
15, 10, 5, 20, 15,
10, 5, 20, 25, 10)
# Tabelle mit absoluten Häufigkeiten
table(verspaetungen)
#Tabelle mit relativen Häufigkeiten
prop.table(table(verspaetungen))
mtcars
# Stabiagramm auf Basis absoluter Häufigkeiten
plot(table(verspaetungen), type = "h",
xlab = "Verspätungen",
ylab = "absolute Häufigkeiten")
# Säulendiagramm auf Basis absoluter Häufigkeiten
barplot(table(verspaetungen),
xlab = "Verspätungen",
ylab = "absolute Häufigkeiten")
wartezeiten <- c(40,20,22,15,18,51,37,42,31,58,
33,39,49,22,23,62,42,53,43,44,
19,49,39,36,37,38,22,24,32,29,
41,40,39,38,27,51,52,54,28,22,
64,19,50,40,18,68,51,41,48,57)
table(wartezeiten)
# Histogramm
hist(wartenzeiten, freq = FALSE,
breaks = c(0, 20, 30, 40, 50, 70))
# Histogramm
hist(wartezeiten, freq = FALSE,
breaks = c(0, 20, 30, 40, 50, 70))
# Histogramm
hist(wartezeiten, freq = FALSE,
breaks = c(0, 20, 30, 40, 50, 70), right = FALSE)
# Histogramm
hist(wartezeiten, freq = FALSE,
breaks = c(0, 20, 30, 40, 50, 70),
right = FALSE)
# Verbindung zu Datenbanken
library(DBI)
con <- DBI::dbConnect(RPostgres::Postgres(),
host   = "wi-sql.fh-muenster.de",
dbname = "airbnb",
user   = "digibim",
password = "Di&i$IM0815",
port     = 5432)
listings <- tbl(con, "listings")
listings <- tbl(con, "listings")
calendar <- tbl(con, "calendar")
hosts <- tbl(con, "hosts")
reviews <- tbl(con, "reviews")
reviewers <- tbl(con, "reviewers")
library(dbplyr)
listings
hosts
names(hosts)
names(listings)
listings %>% group_by(host_id) %>%
summarise(n = n())
listings %>% group_by(host_id) %>%
summarise(n = n()) %>%
arrange(desc(n))
calendar
library(anyflights)
?anyflights
df <- anyflights("ATL", 2022, dir = "/Users/michael/Downloads/")
df <- anyflights("ATL", 2022, dir = "/Users/michael/Downloads/")
df <- anyflights("ATL", 2022, dir = "/Users/michael/Downloads/")
options(timeout = 180)
df <- anyflights("ATL", 2022, dir = "/Users/michael/Downloads/")
df$flights
df$flights
rm(df)
flights <- readRDS("/Users/michael/Downloads/flights.rds")
flights <- readRDS("/Users/michael/Downloads/flights.rda")
flights <- load("/Users/michael/Downloads/flights.rda")
load("/Users/michael/Downloads/airlines.rda")
load("/Users/michael/Downloads/airports.rda")
load("/Users/michael/Downloads/planes.rda")
flights %>% left_join(planes)
library(dplyr)
flights %>% left_join(planes)
planes
flights
load("/Users/michael/Downloads/flights.rda")
df <- flights %>% left_join(planes)
df <- flights %>% left_join(planes, by = "tailnum")
df$seats
df %>% group_by(dest) %>%
summarise(seats = sum(seats)) %>%
arrange(desc(seats))
df <- flights %>% left_join(planes, by = "tailnum") %>%
left_join(airports)
airports
df <- flights %>% left_join(planes, by = "tailnum") %>%
left_join(airports, by = c("dest" = "faa"))
df %>% group_by(dest, name) %>%
summarise(seats = sum(seats)) %>%
arrange(desc(seats))
summarise(seats = sum(seats), flights = n() %>%
df %>% group_by(dest, name) %>%
df %>% group_by(dest, name) %>%
summarise(seats = sum(seats), flights = n() )%>%
arrange(desc(seats))
# Laden der Pakete
library(tidymodels)
library(modeldata)
# Analyse der Daten
summary(mlc_churn)
# Erstellen eines Recipes
mlc_recipe <- recipe(churn ~ ., data = mlc_churn)
mlc_recipe %>%
prep() %>%
bake(new_data = NULL)
table(mlc_churn$state)
# Analyse der Daten
summary(mlc_churn)
# Erstellen eines Recipes
mlc_recipe <- recipe(churn ~ ., data = mlc_churn) %>%
step_mutate(total_minutes = total_day_minutes + total_eve_minutes + total_night_minutes + total_intl_minutes)
mlc_recipe
mlc_recipe %>%
prep() %>%
bake(new_data = NULL)
mlc_recipe %>%
prep()
# Erstellen eines Recipes
mlc_recipe <- recipe(churn ~ ., data = mlc_churn) %>%
step_mutate(total_minutes = total_day_minutes + total_eve_minutes + total_night_minutes + total_intl_minutes,
total_calls = total_day_calls + total_eve_calls + total_night_calls + total_intl_calls,
total_charge = total_day_charge + total_eve_charge + total_night_charge + total_intl_charge)
mlc_recipe %>%
prep() %>%
bake(new_data = NULL)
# Erstellen eines Recipes
mlc_recipe <- recipe(churn ~ ., data = mlc_churn) %>%
step_mutate(total_minutes = total_day_minutes + total_eve_minutes + total_night_minutes + total_intl_minutes,
total_calls = total_day_calls + total_eve_calls + total_night_calls + total_intl_calls,
total_charge = total_day_charge + total_eve_charge + total_night_charge + total_intl_charge,
total_minutes_per_call = total_minutes/total_calls,
total_charge_per_call = total_charge/total_calls,
total_charge_per_minute = total_charge/total_minutes)
mlc_recipe
# Erstellen eines Recipes
mlc_recipe <- recipe(churn ~ ., data = mlc_churn) %>%
step_mutate(total_minutes = total_day_minutes + total_eve_minutes + total_night_minutes + total_intl_minutes) %>%
step_mutate(total_calls = total_day_calls + total_eve_calls + total_night_calls + total_intl_calls,
total_charge = total_day_charge + total_eve_charge + total_night_charge + total_intl_charge,
total_minutes_per_call = total_minutes/total_calls,
total_charge_per_call = total_charge/total_calls,
total_charge_per_minute = total_charge/total_minutes)
mlc_recipe
mlc_recipe %>%
prep() %>%
bake(new_data = NULL)
# Analyse der Daten
summary(mlc_churn)
table(mlc_churn$number_customer_service_calls)
# Erstellen eines Recipes
mlc_recipe <- recipe(churn ~ ., data = mlc_churn) %>%
step_mutate(total_minutes = total_day_minutes + total_eve_minutes + total_night_minutes + total_intl_minutes,
total_calls = total_day_calls + total_eve_calls + total_night_calls + total_intl_calls,
total_charge = total_day_charge + total_eve_charge + total_night_charge + total_intl_charge,
total_minutes_per_call = total_minutes/total_calls,
total_charge_per_call = total_charge/total_calls,
total_charge_per_minute = total_charge/total_minutes) %>%
step_cut(number_customer_service_calls,
breaks = c(0,1,2,3,Inf))
mlc_prepared <-
mlc_recipe %>%
prep() %>%
bake(new_data = NULL)
mlc_prepared$number_customer_service_calls
# Erstellen eines Recipes
mlc_recipe <- recipe(churn ~ ., data = mlc_churn) %>%
step_mutate(total_minutes = total_day_minutes + total_eve_minutes + total_night_minutes + total_intl_minutes,
total_calls = total_day_calls + total_eve_calls + total_night_calls + total_intl_calls,
total_charge = total_day_charge + total_eve_charge + total_night_charge + total_intl_charge,
total_minutes_per_call = total_minutes/total_calls,
total_charge_per_call = total_charge/total_calls,
total_charge_per_minute = total_charge/total_minutes) %>%
step_cut(number_customer_service_calls,
breaks = c(0,1,2,3,Inf), right = FALSE)
mlc_prepared <-
mlc_recipe %>%
prep() %>%
bake(new_data = NULL)
?cut
# Erstellen eines Recipes
mlc_recipe <- recipe(churn ~ ., data = mlc_churn) %>%
step_mutate(total_minutes = total_day_minutes + total_eve_minutes + total_night_minutes + total_intl_minutes,
total_calls = total_day_calls + total_eve_calls + total_night_calls + total_intl_calls,
total_charge = total_day_charge + total_eve_charge + total_night_charge + total_intl_charge,
total_minutes_per_call = total_minutes/total_calls,
total_charge_per_call = total_charge/total_calls,
total_charge_per_minute = total_charge/total_minutes) %>%
step_cut(number_customer_service_calls,
breaks = c(-Inf,0,1,2,3,Inf))
mlc_prepared <-
mlc_recipe %>%
prep() %>%
bake(new_data = NULL)
mlc_prepared$number_customer_service_calls
table(mlc_prepared$number_customer_service_calls)
# Erstellen eines Recipes
mlc_recipe <- recipe(churn ~ ., data = mlc_churn) %>%
step_mutate(total_minutes = total_day_minutes + total_eve_minutes + total_night_minutes + total_intl_minutes,
total_calls = total_day_calls + total_eve_calls + total_night_calls + total_intl_calls,
total_charge = total_day_charge + total_eve_charge + total_night_charge + total_intl_charge,
total_minutes_per_call = total_minutes/total_calls,
total_charge_per_call = total_charge/total_calls,
total_charge_per_minute = total_charge/total_minutes) %>%
step_cut(number_customer_service_calls,
breaks = c(-Inf,0,1,2,Inf))
mlc_prepared <-
mlc_recipe %>%
prep() %>%
bake(new_data = NULL)
table(mlc_prepared$number_customer_service_calls)
mlc_recipe
# Erstellen eines Recipes
mlc_recipe <- recipe(churn ~ ., data = mlc_churn) %>%
step_mutate(total_minutes = total_day_minutes + total_eve_minutes + total_night_minutes + total_intl_minutes,
total_calls = total_day_calls + total_eve_calls + total_night_calls + total_intl_calls,
total_charge = total_day_charge + total_eve_charge + total_night_charge + total_intl_charge,
total_minutes_per_call = total_minutes/total_calls,
total_charge_per_call = total_charge/total_calls,
total_charge_per_minute = total_charge/total_minutes) %>%
step_cut(number_customer_service_calls,
breaks = c(-Inf,0,1,2,Inf)) %>%
step_zv()
mlc_prepared <-
mlc_recipe %>%
prep() %>%
bake(new_data = NULL)
mlc_recipe
mlc_prepared <-
mlc_recipe %>%
prep() %>%
bake(new_data = NULL)
names(car_prices)
USArrests
?USArrests
summary(USArrests)
cor(USArrests)
USArrests[c("Murder", "Assault", "Rape")]
# Cluster analysis
kmeans5 <- kmeans(USArrests[c("Murder", "Assault", "Rape")],
centers = 5, nstart = 10)
kmeans5$cluster
kmeans5$centers
kmeans5$centers[order(kmeans5$cluster$Assault)]
kmeans5$centers[order(kmeans5$centers$Assault)]
order(kmeans5$centers)
kmeans5$centers[order(kmeans5$centers$Assault),]
kmeans5$centers[order(kmeans5$centers[,2]),]
kmeans5$size
kmeans5$iter
kmeans5$cluster
# Analyze clusters
USArrests$Cluster <- kmeans5$cluster
USArrests
library(dplyr)
USArrests %>% group_by(Cluster) %>% summarise_all(mean)
USArrests %>% group_by(Cluster) %>%
summarise_all(mean) %>%
arrange(Assault)
boxplot(USArrests$Murder ~ USArrests$Cluster)
boxplot(USArrests$Assault ~ USArrests$Cluster)
boxplot(USArrests$Rape ~ USArrests$Cluster)
USArrests %>% arrange(Cluster)
kmeans5 <- kmeans(scale(USArrests[c("Murder", "Assault", "Rape")]),
centers = 5, nstart = 10)
kmeans5
# Analyze clusters
USArrests$Cluster <- kmeans5$cluster
library(dplyr)
USArrests %>% group_by(Cluster) %>%
summarise_all(mean) %>%
arrange(Assault)
boxplot(USArrests$Murder ~ USArrests$Cluster)
boxplot(USArrests$Assault ~ USArrests$Cluster)
boxplot(USArrests$Rape ~ USArrests$Cluster)
USArrests %>% arrange(Cluster)
i <- 5
kmeans_tmp <- kmeans(scale(USArrests[c("Murder", "Assault", "Rape")]),
centers = i, nstart = 10)
kmeans_tmp
u
results <- data.frame(Cluster, WithinSS, BetweenSS)
results <- data.frame(Cluster = numeric(),
WithinSS = numeric(),
BetweenSS = numeric())
results
results <- data.frame(Cluster = numeric(),
WithinSS = numeric(),
BetweenSS = numeric())
for (i in 1:10){
kmeans_tmp <- kmeans(scale(USArrests[c("Murder", "Assault", "Rape")]),
centers = i, nstart = 10)
results$Cluster[i] <- i
results$WithinSS[i] <- kmeans_tmp$tot.withinss
results$BetweenSS[i] <- kmeans_tmp$betweenss
}
results <- data.frame(Cluster = 1:10,
WithinSS = numeric(),
BetweenSS = numeric())
results <- data.frame(Cluster = 1:10,
WithinSS = numeric(10),
BetweenSS = numeric(10))
results
for (i in 1:10){
kmeans_tmp <- kmeans(scale(USArrests[c("Murder", "Assault", "Rape")]),
centers = i, nstart = 10)
results$WithinSS[i] <- kmeans_tmp$tot.withinss
results$BetweenSS[i] <- kmeans_tmp$betweenss
}
results
plot(x = results$Cluster, y = results$WithinSS, type = "b")
library(lcda)
install.packages("lcda")
citation("lcda")
?tau.est
??tau.est
library(lcda)
?tau.est
library(devtools)
?submit_cran
submit_cran("RProjects/lcda/")
?use_cran_comments
use_cran_comments()
setwd("RProjects/lcda")
use_cran_comments()
setwd("RProjects/lcda")
submit_cran("RProjects/lcda/")
submit_cran()
submit_cran()
submit_cran()
1634764
1634764*23/24
sqrt(1634764*23/24)
