<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Common Components Latent Class Discriminant Analysis (CCLCDA) — cclcda • lcda</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Common Components Latent Class Discriminant Analysis (CCLCDA) — cclcda"><meta name="description" content="Local Discrimination via Latent Class Models with common components."><meta property="og:description" content="Local Discrimination via Latent Class Models with common components."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lcda</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/lcda.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Common Components Latent Class Discriminant Analysis (CCLCDA)</h1>

      <div class="d-none name"><code>cclcda.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Local Discrimination via Latent Class Models with common components.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cclcda</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">cclcda</span><span class="op">(</span><span class="va">x</span>, grouping<span class="op">=</span><span class="cn">NULL</span>, prior<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                         probs.start<span class="op">=</span><span class="cn">NULL</span>, nrep<span class="op">=</span><span class="fl">1</span>, m<span class="op">=</span><span class="fl">3</span>, </span>
<span>                         maxiter <span class="op">=</span> <span class="fl">1000</span>, tol <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>                         <span class="va">subset</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">cclcda</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Matrix or data frame containing the explanatory variables. Manifest variables must contain only integer values, and must be coded with integers starting at 1. All missing values should be entered as NA.</p></dd>

<dt id="arg-grouping">grouping<a class="anchor" aria-label="anchor" href="#arg-grouping"></a></dt>
<dd><p>A factor specifying the class for each observation; if not specified, the first column of 'data' is taken. The class must be coded by integer values with consecutive values from 1 to the maximum number of classes.</p></dd>

<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Formula of the form <code>'groups ~ x1 + x2 + ...'</code>.</p></dd>

<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame from which variables specified in formula are to be taken.</p></dd>

<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>The prior probabilities of class membership. If unspecified, the class proportions for the training set are used. If present, the probabilities should be specified in the order of the factor levels.</p></dd>

<dt id="arg-probs-start">probs.start<a class="anchor" aria-label="anchor" href="#arg-probs-start"></a></dt>
<dd><p>A list of matrices (per variable) of response probabilities \(\theta_{mkdr}\) to be used as the starting values for the estimation algorithm. Each matrix in the list corresponds to one manifest variable, with one row for each latent class, and one column for each outcome. The default is <code>NULL</code>, producing random starting values. Note that if <code>nrep&gt;1</code>, then any user-specified <code>probs.start</code> values are only used in the first of the nrep attempts.</p></dd>

<dt id="arg-nrep">nrep<a class="anchor" aria-label="anchor" href="#arg-nrep"></a></dt>
<dd><p>Number of times to estimate the model, using different random values of <code>probs.start</code>. The default is one. Setting <code>nrep&gt;1</code> automates the search for the global – rather than just a local – maximum of the log-likelihood function. <code>cclcda</code> uses the parameter estimates corresponding to the model with the greatest log-likelihood.</p></dd>

<dt id="arg-m">m<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>The number of subclasses. Can be either a vector containing the number of subclasses per class or a number of subclasses for all classes. Default is <code>m=3</code>.</p></dd>

<dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>The maximum number of iterations through which the estimation algorithm will cycle.</p></dd>

<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>A tolerance value for judging when convergence has been reached. When the one-iteration change in the estimated log-likelihood is less than <code>tol</code>, the estimation algorithm stops updating and considers the maximum log-likelihood to have been found.</p></dd>

<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>An index vector specifying the cases to be used in the training sample.</p></dd>

<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>Logical, for how <code>cclcda</code> handles cases with missing values on the manifest variables. If <code>TRUE</code>, those cases are removed (listwise deleted) before estimating the model. If <code>FALSE</code>, cases with missing values are retained. Cases with missing covariates are always removed. The default is <code>TRUE</code>.</p></dd>

<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed to <code>cclcda.default</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>cclcda</code>-function performs a Common Components Latent Class Discriminant Analysis (CCLCDA). The model to estimate is
$$f(x) = \sum_{m=1}^{M} w_{m} \prod_{d=1}^D\prod_{r=1}^{R_d} \theta_{mdr}^{x_{dr}},$$
where \(m\) is the latent subclass index, \(d\) is the variable index and \(r\) is the observation index. The variable \(x_{dr}\) is \(1\) if the variable \(d\) of this observation is \(r\).
This common Latent Class Modell will be estimated for all classes by the <code>poLCA</code>-function (see <code><a href="https://rdrr.io/pkg/poLCA/man/poLCA.html" class="external-link">poLCA</a></code>) and class conditional mixing proportions \(w_{mk}\) are computed afterwards. These weights are computed by
$$\frac{1}{N_k} \sum_{n=1}^{N_k}\hat{P}(m, k|X=x_n),$$
where \(k\) is the class index and \(N_k\) the number of observations in class \(k\).</p>
<p>The LCA uses the assumption of local independence to estimate a mixture model of latent multi-way tables, the number of which (<code>m</code>) is specified by the user. Estimated parameters include the latent-class-conditional response probabilities for each manifest variable \(\theta_{mdr}\) and the class conditional mixing proportions \(w_{mk}\) denoting population share of observations corresponding to each latent multi-way table per class.</p>
<p>Posterior class probabilities can be estimated with the <code>predict</code> method.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>cclcda</code> containing the following components:</p>
<dl><dt>call</dt>
<dd><p>The (matched) function call.</p></dd>

<dt>lca.theta</dt>
<dd><p>The estimated class conditional response probabilities of the LCA given as a list of matrices like <code>probs.start</code>.</p></dd>

<dt>lca.w</dt>
<dd><p>The estimated mixing proportions of the LCA.</p></dd>

<dt>lca.wmk</dt>
<dd><p>The estimated class conditional mixing proportions of the LCA.</p></dd>

<dt>prior</dt>
<dd><p>Prior probabilites.</p></dd>

<dt>m</dt>
<dd><p>Number of latent subclasses.</p></dd>

<dt>r</dt>
<dd><p>Number of different responses per variable.</p></dd>

<dt>k</dt>
<dd><p>Number of classes.</p></dd>

<dt>d</dt>
<dd><p>Number of variables.</p></dd>

<dt>aic</dt>
<dd><p>Value of the AIC for each class conditional Latent Class Model.</p></dd>

<dt>bic</dt>
<dd><p>Value of the BIC for each class conditional Latent Class Model.</p></dd>

<dt>Gsq</dt>
<dd><p>The likelihood ratio/deviance statistic for each class conditional model.</p></dd>

<dt>Chisq</dt>
<dd><p>The Pearson Chi-square goodness of fit statistic for fitted vs. observed multiway tables for each class conditional model.</p></dd>

<dt>entropy</dt>
<dd><p>Value of the weighted entropy as described below.</p></dd>

<dt>gini</dt>
<dd><p>Value of the weighted Gini coefficient as described below.</p></dd>

<dt>chi.stat</dt>
<dd><p>Value of the Chi-square test statistik of the test  of latent class membership and class membership as described below.</p></dd>

<dt>chi.p</dt>
<dd><p>P Value of the Chi-square of the test  of latent class membership and class membership as described below.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If the number of latent classes per class is unknown a model selection must be accomplished to determine the value of <code>m</code>. For this goal there are some model selection criteria implemented. The AIC, BIC, likelihood ratio statistic and the Chi-square goodness of fit statistic are taken from the poLCA-function (see <code><a href="https://rdrr.io/pkg/poLCA/man/poLCA.html" class="external-link">poLCA</a></code>).</p>
<p>Additionally <code>cclcda</code> provides quality criteria which should give insight into the model's classification potential. These criteria are similar to the splitting criteria of classification trees. The impurity measures are</p>
<p>– Weighted entropy: The weighted entropy is given by
$$H := - \sum_{m=1}^M  P(m) \sum_{k=1}^K \left(P(k|m) \cdot \log_{K}{P(k|m)}\right).$$</p>
<p>– Weighted Gini coefficient: The weighted Gini coefficient is given by
$$G := \sum_{m=1}^M  P(m) \left[ 1- \sum_{k=1}^{K} \left( P(k|m) \right)^2 \right].$$</p>
<p>– Pearson's Chi-square test: A Pearson's Chi-square test is performed to test the independence of latent class membership and class membership.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael B\"ucker</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="predict.cclcda.html">predict.cclcda</a></code>, <code><a href="lcda.html">lcda</a></code>, <code><a href="predict.lcda.html">predict.lcda</a></code>, <code><a href="cclcda2.html">cclcda2</a></code>, <code><a href="predict.cclcda2.html">predict.cclcda2</a></code>, <code><a href="https://rdrr.io/pkg/poLCA/man/poLCA.html" class="external-link">poLCA</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># response probabilites</span></span></span>
<span class="r-in"><span><span class="va">probs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">probs1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                        <span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.7</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      nrow<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">probs1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                        <span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      nrow<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">probs1</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.7</span>,</span></span>
<span class="r-in"><span>                        <span class="fl">0.7</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      nrow<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">probs1</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                        <span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      nrow<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wmk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">0.45</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.45</span>,<span class="fl">0.45</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              ncol<span class="op">=</span><span class="fl">4</span>, nrow<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wkm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">wmk</span><span class="op">*</span><span class="va">prior</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generation of training data</span></span></span>
<span class="r-in"><span><span class="va">data_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/poLCA/man/poLCA.simdata.html" class="external-link">poLCA.simdata</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, probs <span class="op">=</span> <span class="va">probs1</span>,</span></span>
<span class="r-in"><span>                           nclass <span class="op">=</span> <span class="fl">2</span>, ndv <span class="op">=</span> <span class="fl">4</span>, nresp <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                           P<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data_temp</span><span class="op">$</span><span class="va">dat</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">lclass</span> <span class="op">&lt;-</span> <span class="va">data_temp</span><span class="op">$</span><span class="va">trueclass</span></span></span>
<span class="r-in"><span><span class="va">grouping</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lclass</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">grouping</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fl">1</span>, prob<span class="op">=</span><span class="va">wkm</span><span class="op">[</span>,<span class="va">lclass</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generation of test data</span></span></span>
<span class="r-in"><span><span class="va">data_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/poLCA/man/poLCA.simdata.html" class="external-link">poLCA.simdata</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">500</span>, probs <span class="op">=</span> <span class="va">probs1</span>,</span></span>
<span class="r-in"><span>                           nclass <span class="op">=</span> <span class="fl">2</span>, ndv <span class="op">=</span> <span class="fl">4</span>, nresp <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                           P<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">data.test</span> <span class="op">&lt;-</span> <span class="va">data_temp</span><span class="op">$</span><span class="va">dat</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">lclass</span> <span class="op">&lt;-</span> <span class="va">data_temp</span><span class="op">$</span><span class="va">trueclass</span></span></span>
<span class="r-in"><span><span class="va">grouping.test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lclass</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">grouping.test</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fl">1</span>, prob<span class="op">=</span><span class="va">wkm</span><span class="op">[</span>,<span class="va">lclass</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># cclcda-procedure</span></span></span>
<span class="r-in"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu">cclcda</span><span class="op">(</span><span class="va">data</span>, <span class="va">grouping</span>, m<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">object</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cclcda.default(x = data, grouping = grouping, m = 4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of classes:  2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prior probabilites:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class 1: 0.47 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class 2: 0.53 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of latent classes:  4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC:  9808.12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC:  10136.94 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gsq:  216.65 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chisq:  188.07 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Entropy:  0.71 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gini:  0.31 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chisq-statistic:  369.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chisq p-value:  0 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Buecker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

