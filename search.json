[{"path":"https://mchlbckr.github.io/lcda/articles/lcda.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Latent Class Discriminant Analysis","text":"lcda package provides latent class discriminant analysis methods categorical predictors. main functions : lcda() class-specific latent class models. cclcda() common-components latent class models. cclcda2() common-components models class-conditional mixing weights. manifest variables class labels must integer-coded start 1.","code":""},{"path":"https://mchlbckr.github.io/lcda/articles/lcda.html","id":"background","dir":"Articles","previous_headings":"","what":"Background","title":"Latent Class Discriminant Analysis","text":"methods lcda implement local discrimination discrete variables using latent class analysis (LCA). key idea replace single class-conditional distribution finite mixture locally independent components. lets class capture heterogeneity keeping model tractable categorical data. Let K number classes, M number latent components, D number manifest variables, R_d number outcomes variable d. indicator x_dr equals 1 variable d takes outcome r 0 otherwise.","code":""},{"path":[]},{"path":"https://mchlbckr.github.io/lcda/articles/lcda.html","id":"lcda-class-specific-mixtures","dir":"Articles","previous_headings":"Models","what":"LCDA (class-specific mixtures)","title":"Latent Class Discriminant Analysis","text":"class latent class model: fk(x)=∑m=1Mkwmk∏d=1D∏r=1Rdθmkdrxdr f_k(x) = \\sum_{m=1}^{M_k} w_{mk} \\prod_{d=1}^D \\prod_{r=1}^{R_d} \\theta_{mkdr}^{x_{dr}} Classification follows Bayes decision rule: k̂(x)=argmaxkπkfk(x) \\hat{k}(x) = \\arg\\max_k \\pi_k f_k(x)","code":""},{"path":"https://mchlbckr.github.io/lcda/articles/lcda.html","id":"cclcda-common-components","dir":"Articles","previous_headings":"Models","what":"CCLCDA (common components)","title":"Latent Class Discriminant Analysis","text":"Common-components models share component distributions across classes, allowing class-specific mixing weights: fk(x)=∑m=1Mwmk∏d=1D∏r=1Rdθmdrxdr f_k(x) = \\sum_{m=1}^{M} w_{mk} \\prod_{d=1}^D \\prod_{r=1}^{R_d} \\theta_{mdr}^{x_{dr}} cclcda() first estimates shared LCA pooled data derives class-conditional weights. cclcda2() estimates weights response probabilities jointly EM step.","code":""},{"path":"https://mchlbckr.github.io/lcda/articles/lcda.html","id":"estimation-and-model-selection","dir":"Articles","previous_headings":"","what":"Estimation and model selection","title":"Latent Class Discriminant Analysis","text":"Parameter estimation uses EM algorithm random starts (see nrep). Model selection can guided AIC, BIC, likelihood ratio statistic (Gsq), Pearson chi-square statistic (Chisq). common-components models, additional quality measures provided: Weighted entropy, measuring purity latent components. Weighted Gini, alternative impurity measure. chi-square test independence latent components classes. reported fitted model objects returned cclcda() cclcda2().","code":""},{"path":"https://mchlbckr.github.io/lcda/articles/lcda.html","id":"example-ccl-cda2-on-iris","dir":"Articles","previous_headings":"","what":"Example: CCL-CDA2 on Iris","title":"Latent Class Discriminant Analysis","text":"","code":"library(lcda) #> Loading required package: poLCA #> Loading required package: scatterplot3d #> Loading required package: MASS  data(iris)  iris_cat <- within(iris, {   Sepal.Length <- as.integer(cut(Sepal.Length, breaks = c(-Inf, 5.1, 5.8, 6.4, Inf)))   Sepal.Width <- as.integer(cut(Sepal.Width, breaks = c(-Inf, 2.8, 3.0, 3.3, Inf)))   Petal.Length <- as.integer(cut(Petal.Length, breaks = c(-Inf, 1.6, 4.35, 5.1, Inf)))   Petal.Width <- as.integer(cut(Petal.Width, breaks = c(-Inf, 0.3, 1.3, 1.8, Inf)))   Species3 <- as.integer(Species) })  model <- cclcda2(   Species3 ~ Sepal.Length + Sepal.Width + Petal.Length + Petal.Width,   data = iris_cat,   m = 1 )  model$bic #> [1] 1715.472"},{"path":"https://mchlbckr.github.io/lcda/articles/lcda.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Latent Class Discriminant Analysis","text":"Bücker, M., Szepannek, G., Weihs, C. (2010). Local Classification Discrete Variables Latent Class Models. : Locarek-Junge, H., Weihs, C. (eds) Classification Tool Research. Studies Classification, Data Analysis, Knowledge Organization. Springer, Berlin, Heidelberg. https://doi.org/10.1007/978-3-642-10745-0_13 Bücker, M. (2008). Lokale Diskrimination diskreter Daten. Diplomarbeit, Fakultaet Statistik, TU Dortmund.","code":""},{"path":"https://mchlbckr.github.io/lcda/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Bücker. Author, maintainer.","code":""},{"path":"https://mchlbckr.github.io/lcda/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Bücker M (2026). lcda: Latent Class Discriminant Analysis. doi:10.32614/CRAN.package.lcda, R package version 0.3.3, https://CRAN.R-project.org/package=lcda.","code":"@Manual{,   title = {lcda: Latent Class Discriminant Analysis},   author = {Michael Bücker},   year = {2026},   note = {R package version 0.3.3},   url = {https://CRAN.R-project.org/package=lcda},   doi = {10.32614/CRAN.package.lcda}, }"},{"path":"https://mchlbckr.github.io/lcda/index.html","id":"lcda","dir":"","previous_headings":"","what":"Latent Class Discriminant Analysis","title":"Latent Class Discriminant Analysis","text":"Latent class discriminant analysis categorical data, including local common-components variants.","code":""},{"path":"https://mchlbckr.github.io/lcda/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Latent Class Discriminant Analysis","text":"CRAN: Development version:","code":"install.packages(\"lcda\") remotes::install_github(\"mchlbckr/lcda\")"},{"path":"https://mchlbckr.github.io/lcda/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Latent Class Discriminant Analysis","text":"","code":"library(lcda)  # See ?lcda, ?cclcda, and ?cclcda2 for examples"},{"path":"https://mchlbckr.github.io/lcda/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Latent Class Discriminant Analysis","text":"Key functions: lcda(): fits separate latent class models per class. cclcda(): fits common-components latent class model class-specific mixing proportions. cclcda2(): fits common-components model class-conditional mixing proportions. Data requirements: Manifest variables must integer-coded start 1. Grouping labels must integer-coded start 1.","code":""},{"path":"https://mchlbckr.github.io/lcda/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Latent Class Discriminant Analysis","text":"package includes vignette worked example:","code":"vignette(\"lcda\")"},{"path":"https://mchlbckr.github.io/lcda/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"Latent Class Discriminant Analysis","text":"Bücker, M., Szepannek, G., Weihs, C. (2010). Local Classification Discrete Variables Latent Class Models. : Locarek-Junge, H., Weihs, C. (eds) Classification Tool Research. Studies Classification, Data Analysis, Knowledge Organization. Springer, Berlin, Heidelberg. https://doi.org/10.1007/978-3-642-10745-0_13 Bücker, M. (2008). Lokale Diskrimination diskreter Daten. Diplomarbeit, Fakultaet Statistik, TU Dortmund.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda.html","id":null,"dir":"Reference","previous_headings":"","what":"Common Components Latent Class Discriminant Analysis (CCLCDA) — cclcda","title":"Common Components Latent Class Discriminant Analysis (CCLCDA) — cclcda","text":"Local Discrimination via Latent Class Models common components.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Common Components Latent Class Discriminant Analysis (CCLCDA) — cclcda","text":"","code":"cclcda(x, ...)   # Default S3 method cclcda(x, grouping=NULL, prior=NULL,                          probs.start=NULL, nrep=1, m=3,                           maxiter = 1000, tol = 1e-10,                          subset, na.rm = FALSE, ...)  # S3 method for class 'formula' cclcda(formula, data, ...)"},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Common Components Latent Class Discriminant Analysis (CCLCDA) — cclcda","text":"x Matrix data frame containing explanatory variables. Manifest variables must contain integer values, must coded integers starting 1. missing values entered NA. grouping factor specifying class observation; specified, first column 'data' taken. class must coded integer values consecutive values 1 maximum number classes. formula Formula form 'groups ~ x1 + x2 + ...'. data Data frame variables specified formula taken. prior prior probabilities class membership. unspecified, class proportions training set used. present, probabilities specified order factor levels. probs.start list matrices (per variable) response probabilities \\(\\theta_{mkdr}\\) used starting values estimation algorithm. matrix list corresponds one manifest variable, one row latent class, one column outcome. default NULL, producing random starting values. Note nrep>1, user-specified probs.start values used first nrep attempts. nrep Number times estimate model, using different random values probs.start. default one. Setting nrep>1 automates search global – rather just local – maximum log-likelihood function. cclcda uses parameter estimates corresponding model greatest log-likelihood. m number subclasses. Can either vector containing number subclasses per class number subclasses classes. Default m=3. maxiter maximum number iterations estimation algorithm cycle. tol tolerance value judging convergence reached. one-iteration change estimated log-likelihood less tol, estimation algorithm stops updating considers maximum log-likelihood found. subset index vector specifying cases used training sample. na.rm Logical, cclcda handles cases missing values manifest variables. TRUE, cases removed (listwise deleted) estimating model. FALSE, cases missing values retained. Cases missing covariates always removed. default TRUE. ... arguments passed cclcda.default.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Common Components Latent Class Discriminant Analysis (CCLCDA) — cclcda","text":"cclcda-function performs Common Components Latent Class Discriminant Analysis (CCLCDA). model estimate $$f(x) = \\sum_{m=1}^{M} w_{m} \\prod_{d=1}^D\\prod_{r=1}^{R_d} \\theta_{mdr}^{x_{dr}},$$ \\(m\\) latent subclass index, \\(d\\) variable index \\(r\\) observation index. variable \\(x_{dr}\\) \\(1\\) variable \\(d\\) observation \\(r\\). common Latent Class Modell estimated classes poLCA-function (see poLCA) class conditional mixing proportions \\(w_{mk}\\) computed afterwards. weights computed $$\\frac{1}{N_k} \\sum_{n=1}^{N_k}\\hat{P}(m, k|X=x_n),$$ \\(k\\) class index \\(N_k\\) number observations class \\(k\\). LCA uses assumption local independence estimate mixture model latent multi-way tables, number (m) specified user. Estimated parameters include latent-class-conditional response probabilities manifest variable \\(\\theta_{mdr}\\) class conditional mixing proportions \\(w_{mk}\\) denoting population share observations corresponding latent multi-way table per class. Posterior class probabilities can estimated predict method.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Common Components Latent Class Discriminant Analysis (CCLCDA) — cclcda","text":"list class cclcda containing following components: call (matched) function call. lca.theta estimated class conditional response probabilities LCA given list matrices like probs.start. lca.w estimated mixing proportions LCA. lca.wmk estimated class conditional mixing proportions LCA. prior Prior probabilites. m Number latent subclasses. r Number different responses per variable. k Number classes. d Number variables. aic Value AIC class conditional Latent Class Model. bic Value BIC class conditional Latent Class Model. Gsq likelihood ratio/deviance statistic class conditional model. Chisq Pearson Chi-square goodness fit statistic fitted vs. observed multiway tables class conditional model. entropy Value weighted entropy described . gini Value weighted Gini coefficient described . chi.stat Value Chi-square test statistik test  latent class membership class membership described . chi.p P Value Chi-square test  latent class membership class membership described .","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Common Components Latent Class Discriminant Analysis (CCLCDA) — cclcda","text":"number latent classes per class unknown model selection must accomplished determine value m. goal model selection criteria implemented. AIC, BIC, likelihood ratio statistic Chi-square goodness fit statistic taken poLCA-function (see poLCA). Additionally cclcda provides quality criteria give insight model's classification potential. criteria similar splitting criteria classification trees. impurity measures – Weighted entropy: weighted entropy given $$H := - \\sum_{m=1}^M  P(m) \\sum_{k=1}^K \\left(P(k|m) \\cdot \\log_{K}{P(k|m)}\\right).$$ – Weighted Gini coefficient: weighted Gini coefficient given $$G := \\sum_{m=1}^M  P(m) \\left[ 1- \\sum_{k=1}^{K} \\left( P(k|m) \\right)^2 \\right].$$ – Pearson's Chi-square test: Pearson's Chi-square test performed test independence latent class membership class membership.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Common Components Latent Class Discriminant Analysis (CCLCDA) — cclcda","text":"Michael B\\\"ucker","code":""},{"path":[]},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Common Components Latent Class Discriminant Analysis (CCLCDA) — cclcda","text":"","code":"# response probabilites probs1 <- list()  probs1[[1]] <- matrix(c(0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1,                         0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7),                        nrow=4, byrow=TRUE) probs1[[2]] <- matrix(c(0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1,                         0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1),                       nrow=4, byrow=TRUE) probs1[[3]] <- matrix(c(0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7,                         0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1),                       nrow=4, byrow=TRUE) probs1[[4]] <- matrix(c(0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1,                         0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1),                       nrow=4, byrow=TRUE)  prior <- c(0.5,0.5) wmk <- matrix(c(0.45,0.45,0.05,0.05,0.05,0.05,0.45,0.45),               ncol=4, nrow=2, byrow=TRUE) wkm <- apply(wmk*prior, 2, function(x) x/sum(x))  # generation of training data data_temp <- poLCA.simdata(N = 1000, probs = probs1,                            nclass = 2, ndv = 4, nresp = 4,                            P=rep(0.25,4))  data <- data_temp$dat + 1 lclass <- data_temp$trueclass grouping <- numeric() for (i in 1:length(lclass)) { grouping[i] <- sample(c(1,2),1, prob=wkm[,lclass[i]]) }  # generation of test data data_temp <- poLCA.simdata(N = 500, probs = probs1,                            nclass = 2, ndv = 4, nresp = 4,                            P=rep(0.25,4))  data.test <- data_temp$dat + 1 lclass <- data_temp$trueclass grouping.test <- numeric() for (i in 1:length(lclass)) { grouping.test[i] <- sample(c(1,2),1, prob=wkm[,lclass[i]]) }  # cclcda-procedure object <- cclcda(data, grouping, m=4) object #> Call: #> cclcda.default(x = data, grouping = grouping, m = 4) #>  #> Number of classes:  2  #>  #> Prior probabilites: #> class 1: 0.47  #> class 2: 0.53  #>  #> Number of latent classes:  4  #>  #> AIC:  9808.12  #>  #> BIC:  10136.94  #>  #> Gsq:  216.65  #>  #> Chisq:  188.07  #>  #> Entropy:  0.71  #>  #> Gini:  0.31  #>  #> Chisq-statistic:  369.4  #>  #> Chisq p-value:  0"},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda2.html","id":null,"dir":"Reference","previous_headings":"","what":"Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — cclcda2","title":"Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — cclcda2","text":"Local Discrimination via Latent Class Models common components","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — cclcda2","text":"","code":"cclcda2(x, ...)  # Default S3 method cclcda2(x, grouping=NULL, prior=NULL,                           probs.start=NULL, wmk.start=NULL,                            nrep=1, m=3, maxiter = 1000,                            tol = 1e-10, subset, na.rm = FALSE, ...)  # S3 method for class 'formula' cclcda2(formula, data, ...)"},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — cclcda2","text":"x Matrix data frame containing explanatory variables. Manifest variables must contain integer values, must coded integers starting 1. missing values entered NA. grouping factor specifying class observation; specified, first column 'data' taken. class must coded integer values consecutive values 1 maximum number classes. formula Formula form 'groups ~ x1 + x2 + ...'. data Data frame variables specified formula taken. prior prior probabilities class membership. unspecified, class proportions training set used. present, probabilities specified order factor levels. probs.start list matrices (per variable) response probabilities \\(\\theta_{mkdr}\\) used starting values estimation algorithm. matrix list corresponds one manifest variable, one row latent class, one column outcome. default NULL, producing random starting values. Note nrep>1, user-specified probs.start values used first nrep attempts. wmk.start matrix starting values parameter \\(w_{mk}\\) (see details). default NULL, producing random starting values. Note nrep>1, user-specified wmk.start values used first nrep attempts. nrep Number times estimate model, using different random values probs.start. default one. Setting nrep>1 automates search global – rather just local – maximum log-likelihood function. cclcda2 uses parameter estimates corresponding model greatest log-likelihood. m number subclasses. Can either vector containing number subclasses per class number subclasses classes. Default m=3. maxiter maximum number iterations estimation algorithm cycle. tol tolerance value judging convergence reached. one-iteration change estimated log-likelihood less tol, estimation algorithm stops updating considers maximum log-likelihood found. subset index vector specifying cases used training sample. na.rm Logical, cclcda2 handles cases missing values manifest variables. TRUE, cases removed (listwise deleted) estimating model. FALSE, cases missing values retained. Cases missing covariates always removed. default TRUE. ... arguments passed cclcda2.default.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — cclcda2","text":"cclcda2-function performs Common Components Latent Class Discriminant Analysis 2 (CCLCDA2). class conditional model estimate $$f_k(x) = \\sum_{m=1}^{M_k} w_{mk} \\prod_{d=1}^D\\prod_{r=1}^{R_d} \\theta_{mdr}^{x_{dr}},$$ \\(m\\) latent subclass index, \\(d\\) variable index \\(r\\) observation index. variable \\(x_{dr}\\) \\(1\\) variable \\(d\\) observation \\(r\\). Latent Class Modell estimated. class conditional mixing proportions \\(w_{mk}\\) parameters \\(\\theta_{mdr}\\) computed every step EM-Algorithm. LCA uses assumption local independence estimate mixture model latent multi-way tables, number (m) specified user. Estimated parameters include latent-class-conditional response probabilities manifest variable \\(\\theta_{mdr}\\) class conditional mixing proportions \\(w_{mk}\\) denoting population share observations corresponding latent multi-way table per class. Posterior class probabilities can estimated predict method.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — cclcda2","text":"list class cclcda2 containing following components: call (matched) function call. lca.theta estimated class conditional response probabilities LCA given list matrices like probs.start. lca.w estimated mixing proportions LCA. lca.wmk estimated class conditional mixing proportions LCA. prior Prior probabilites. m Number latent subclasses. r Number different responses per variable. k Number classes. d Number variables. aic Value AIC class conditional Latent Class Model. bic Value BIC class conditional Latent Class Model. Gsq likelihood ratio/deviance statistic class conditional model. Chisq Pearson Chi-square goodness fit statistic fitted vs. observed multiway tables class conditional model. entropy Value weighted entropy described . gini Value weighted Gini coefficient described . chi.stat Value Chi-square test statistik test  latent class membership class membership described . chi.p P Value Chi-square test  latent class membership class membership described .","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda2.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — cclcda2","text":"number latent classes per class unknown model selection must accomplished determine value m. goal model selection criteria implemented. AIC, BIC, likelihood ratio statistic Chi-square goodness fit statistic taken poLCA-function (see poLCA). Additionally cclcda2 provides quality criteria give insight model's classification potential. criteria similar splitting criteria classification trees. impurity measures – Weighted entropy: weighted entropy given $$H := - \\sum_{m=1}^M  P(m) \\sum_{k=1}^K \\left(P(k|m) \\cdot \\log_{K}{P(k|m)}\\right).$$ – Weighted Gini coefficient: weighted Gini coefficient given $$G := \\sum_{m=1}^M  P(m) \\left[ 1- \\sum_{k=1}^{K} \\left( P(k|m) \\right)^2 \\right].$$ – Pearson's Chi-square test: Pearson's Chi-square test performed test independence latent class membership class membership.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — cclcda2","text":"Michael B\\\"ucker","code":""},{"path":[]},{"path":"https://mchlbckr.github.io/lcda/reference/cclcda2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — cclcda2","text":"","code":"# response probabilites probs1 <- list()  probs1[[1]] <- matrix(c(0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1,                         0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7),                        nrow=4, byrow=TRUE) probs1[[2]] <- matrix(c(0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1,                         0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1),                       nrow=4, byrow=TRUE) probs1[[3]] <- matrix(c(0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7,                         0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1),                       nrow=4, byrow=TRUE) probs1[[4]] <- matrix(c(0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1,                         0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1),                       nrow=4, byrow=TRUE)  prior <- c(0.5,0.5) wmk <- matrix(c(0.45,0.45,0.05,0.05,0.05,0.05,0.45,0.45),               ncol=4, nrow=2, byrow=TRUE) wkm <- apply(wmk*prior, 2, function(x) x/sum(x))  # generation of training data data_temp <- poLCA.simdata(N = 1000, probs = probs1,                            nclass = 2, ndv = 4, nresp = 4,                            P=rep(0.25,4))  data <- data_temp$dat + 1 lclass <- data_temp$trueclass grouping <- numeric() for (i in 1:length(lclass)) { grouping[i] <- sample(c(1,2),1, prob=wkm[,lclass[i]]) }  # generation of test data data_temp <- poLCA.simdata(N = 500, probs = probs1,                            nclass = 2, ndv = 4, nresp = 4,                            P=rep(0.25,4))  data.test <- data_temp$dat + 1 lclass <- data_temp$trueclass grouping.test <- numeric() for (i in 1:length(lclass)) { grouping.test[i] <- sample(c(1,2),1, prob=wkm[,lclass[i]]) }  # cclcda-procedure object <- cclcda2(data, grouping, m=4) object #> Call: #> cclcda2.default(x = data, grouping = grouping, m = 4) #>  #> Number of classes:  2  #>  #> Prior probabilites: #> class 1: 0.5  #> class 2: 0.5  #>  #> Number of latent classes:  4  #>  #> AIC:  10258.57  #>  #> BIC:  10587.39  #>  #> Gsq:  764.74  #>  #> Chisq:  999.97  #>  #> Entropy:  0.4  #>  #> Gini:  0.16  #>  #> Chisq-statistic:  679.1  #>  #> Chisq p-value:  0"},{"path":"https://mchlbckr.github.io/lcda/reference/lcda.html","id":null,"dir":"Reference","previous_headings":"","what":"Latent Class Discriminant Analysis (LCDA) — lcda","title":"Latent Class Discriminant Analysis (LCDA) — lcda","text":"Local Discrimination via Latent Class Models","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/lcda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Latent Class Discriminant Analysis (LCDA) — lcda","text":"","code":"lcda(x, ...)   # Default S3 method lcda(x, grouping=NULL, prior=NULL,                        probs.start=NULL, nrep=1, m=3,                         maxiter = 1000, tol = 1e-10,                        subset, na.rm = FALSE, ...)  # S3 method for class 'formula' lcda(formula, data, ...)"},{"path":"https://mchlbckr.github.io/lcda/reference/lcda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Latent Class Discriminant Analysis (LCDA) — lcda","text":"x Matrix data frame containing explanatory variables. Manifest variables must contain integer values, must coded integers starting 1. missing values entered NA. grouping factor specifying class observation; specified, first column data taken. class must coded integer values consecutive values 1 maximum number classes. formula Formula form 'groups ~ x1 + x2 + ...'. data Data frame variables specified formula taken. prior prior probabilities class membership. unspecified, class proportions training set used. present, probabilities specified order factor levels. probs.start list (per class) lists matrices (per variable) response probabilities \\(\\theta_{mkdr}\\) used starting values estimation algorithm. matrix list corresponds one manifest variable, one row latent class, one column outcome. default NULL, producing random starting values. Note nrep>1, user-specified probs.start values used first nrep attempts. nrep Number times estimate model, using different random values probs.start. default one. Setting nrep>1 automates search global – rather just local – maximum log-likelihood function. lcda uses parameter estimates corresponding model greatest log-likelihood. m number subclasses per class. Can either vector containing number subclasses per class number subclasses classes. Default m=3. maxiter maximum number iterations estimation algorithm cycle. tol tolerance value judging convergence reached. one-iteration change estimated log-likelihood less tol, estimation algorithm stops updating considers maximum log-likelihood found. subset index vector specifying cases used training sample. na.rm Logical, lcda handles cases missing values manifest variables. TRUE, cases removed (listwise deleted) estimating model. FALSE, cases missing values retained. Cases missing covariates always removed. default TRUE. ... arguments passed lcda.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/lcda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Latent Class Discriminant Analysis (LCDA) — lcda","text":"lcda-function performs Latent Class Discriminant Analysis (LCDA).  Latent Class Modell estimated class poLCA-function (see poLCA). class conditional model given $$f_k(x) = \\sum_{m=1}^{M_k} w_{mk} \\prod_{d=1}^D\\prod_{r=1}^{R_d} \\theta_{mkdr}^{x_{kdr}},$$ \\(k\\) class index, \\(m\\) latent subclass index, \\(d\\) variable index \\(r\\) observation index. variable \\(x_{kdr}\\) \\(1\\) variable \\(d\\) observation \\(r\\) class \\(k\\). parameter \\(w_{mk}\\) class conditional mixture weight \\(\\theta_{mkdr}\\) probability outcome \\(r\\) variable \\(d\\) subclass \\(m\\) class \\(k\\). Latent Class Models use assumption local independence estimate mixture model latent multi-way tables. mixture models estimated EM-algorithm. number mixture components (m) specified user. Estimated parameters include latent-class conditional response probabilities manifest variable  \\(\\theta_{mkdr}\\) class conditional mixing proportions \\(w_{mk}\\) denoting population share observations corresponding latent multi-way table. Posterior class probabilities class memberships can estimated predict method.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/lcda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Latent Class Discriminant Analysis (LCDA) — lcda","text":"list class lcda containing following components: call (matched) function call. lca.theta estimated class conditional response probabilities LCA given list matrices like probs.start. lca.w estimated mixing proportions LCA. prior Prior probabilites. m Number latent subclasses per class. r Number possible responses per variable. k Number classes. d Number variables. aic Value AIC class conditional Latent Class Model. bic Value BIC class conditional Latent Class Model. Gsq likelihood ratio/deviance statistic class conditional model. Chisq Pearson Chi-square goodness fit statistic fitted vs. observed multiway tables class conditional model.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/lcda.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Latent Class Discriminant Analysis (LCDA) — lcda","text":"number latent classes per class unknown model selection must accomplished determine value m. goal model selection criteria implemented. AIC, BIC, likelihood ratio statistic Chi-square goodness fit statistic taken poLCA-function (see poLCA). class criteria can regarded separately class number latent classes can determined.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/lcda.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Latent Class Discriminant Analysis (LCDA) — lcda","text":"Michael B\\\"ucker","code":""},{"path":[]},{"path":"https://mchlbckr.github.io/lcda/reference/lcda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Latent Class Discriminant Analysis (LCDA) — lcda","text":"","code":"# response probabilites for class 1 probs1 <- list() probs1[[1]] <- matrix(c(0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1),                        nrow=2, byrow=TRUE) probs1[[2]] <- matrix(c(0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1),                       nrow=2, byrow=TRUE) probs1[[3]] <- matrix(c(0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7),                       nrow=2, byrow=TRUE) probs1[[4]] <- matrix(c(0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1),                       nrow=2, byrow=TRUE)  # response probabilites for class 2 probs2 <- list() probs2[[1]] <- matrix(c(0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7),                       nrow=2, byrow=TRUE) probs2[[2]] <- matrix(c(0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1),                       nrow=2, byrow=TRUE) probs2[[3]] <- matrix(c(0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1),                       nrow=2, byrow=TRUE) probs2[[4]] <- matrix(c(0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1),                       nrow=2, byrow=TRUE)  # generation of data simdata1 <- poLCA.simdata(N = 500, probs = probs1, nclass = 2,               ndv = 4, nresp = 4, missval = FALSE)  simdata2 <- poLCA.simdata(N = 500, probs = probs2, nclass = 2,               ndv = 4, nresp = 4, missval = FALSE)  data1 <- simdata1$dat data2 <- simdata2$dat  data <- cbind(rbind(data1, data2), rep(c(1,2), each=500)) names(data)[5] <- \"grouping\" data <- data[sample(1:1000),] grouping <- data[[5]] data <- data[,1:4]  # lcda-procedure object <- lcda(data, grouping=grouping, m=2) object #> Call: #> lcda.default(x = data, grouping = grouping, m = 2) #>  #> Number of classes:  2  #>  #> Prior probabilites: #> class 1: 0.5  #> class 2: 0.5  #>  #> Number of subclasses: #> class 1: 2  #> class 2: 2  #>  #> AIC: #> class 1: 4268.37  #> class 2: 4298.87  #>  #> BIC: #> class 1: 4373.73  #> class 2: 4404.23  #>  #> Gsq: #> class 1: 180.78  #> class 2: 213.84  #>  #> Chisq: #> class 1: 179.86  #> class 2: 235.77"},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method for Common Components Latent Class Discriminant Analysis (CCLCDA) — predict.cclcda","title":"Predict method for Common Components Latent Class Discriminant Analysis (CCLCDA) — predict.cclcda","text":"Classifies new observations using parameters determined cclcda-function.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method for Common Components Latent Class Discriminant Analysis (CCLCDA) — predict.cclcda","text":"","code":"# S3 method for class 'cclcda' predict(object, newdata, ...)"},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method for Common Components Latent Class Discriminant Analysis (CCLCDA) — predict.cclcda","text":"object Object class cclcda. newdata Data frame cases classified. ... arguments ignored.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict method for Common Components Latent Class Discriminant Analysis (CCLCDA) — predict.cclcda","text":"Posterior probabilities new observations using parameters determined cclcda-function computed. classification new data done Bayes decision function.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict method for Common Components Latent Class Discriminant Analysis (CCLCDA) — predict.cclcda","text":"list components: class Vector (class factor) classifications. posterior Posterior probabilities classes.     details computation see cclcda.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Predict method for Common Components Latent Class Discriminant Analysis (CCLCDA) — predict.cclcda","text":"Michael B\\\"ucker","code":""},{"path":[]},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict method for Common Components Latent Class Discriminant Analysis (CCLCDA) — predict.cclcda","text":"","code":"# response probabilites probs1 <- list()  probs1[[1]] <- matrix(c(0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1,                         0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7),                        nrow=4, byrow=TRUE) probs1[[2]] <- matrix(c(0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1,                         0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1),                       nrow=4, byrow=TRUE) probs1[[3]] <- matrix(c(0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7,                         0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1),                       nrow=4, byrow=TRUE) probs1[[4]] <- matrix(c(0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1,                         0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1),                       nrow=4, byrow=TRUE)  prior <- c(0.5,0.5) wmk <- matrix(c(0.45,0.45,0.05,0.05,0.05,0.05,0.45,0.45),               ncol=4, nrow=2, byrow=TRUE) wkm <- apply(wmk*prior, 2, function(x) x/sum(x))  # generation of training data data_temp <- poLCA.simdata(N = 1000, probs = probs1,                            nclass = 2, ndv = 4, nresp = 4,                            P=rep(0.25,4)) data <- data_temp$dat lclass <- data_temp$trueclass grouping <- numeric() for (i in 1:length(lclass)) { grouping[i] <- sample(c(1,2),1, prob=wkm[,lclass[i]]) }  # generation of test data data_temp <- poLCA.simdata(N = 500, probs = probs1,                            nclass = 2, ndv = 4, nresp = 4,                            P=rep(0.25,4)) data.test <- data_temp$dat lclass <- data_temp$trueclass grouping.test <- numeric() for (i in 1:length(lclass)) { grouping.test[i] <- sample(c(1,2),1, prob=wkm[,lclass[i]]) }  # cclcda-procedure object <- cclcda(data, grouping, m=4) pred <- predict(object, data.test)$class 1-(sum(pred==grouping.test)/500) #> [1] 0.16"},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda2.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method for Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — predict.cclcda2","title":"Predict method for Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — predict.cclcda2","text":"Classifies new observations using parameters determined cclcda2-function.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method for Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — predict.cclcda2","text":"","code":"# S3 method for class 'cclcda2' predict(object, newdata, ...)"},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method for Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — predict.cclcda2","text":"object Object class cclcda2. newdata Data frame cases classified. ... arguments ignored.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict method for Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — predict.cclcda2","text":"Posterior probabilities new observations using parameters determined cclcda2-function computed. classification new data done Bayes decision function.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict method for Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — predict.cclcda2","text":"list components: class Vector (class factor) classifications. posterior Posterior probabilities classes.     details computation see cclcda2.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Predict method for Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — predict.cclcda2","text":"Michael B\\\"ucker","code":""},{"path":[]},{"path":"https://mchlbckr.github.io/lcda/reference/predict.cclcda2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict method for Common Components Latent Class Discriminant Analysis 2 (CCLCDA2) — predict.cclcda2","text":"","code":"# response probabilites probs1 <- list()  probs1[[1]] <- matrix(c(0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1,                         0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7),                        nrow=4, byrow=TRUE) probs1[[2]] <- matrix(c(0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1,                         0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1),                       nrow=4, byrow=TRUE) probs1[[3]] <- matrix(c(0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7,                         0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1),                       nrow=4, byrow=TRUE) probs1[[4]] <- matrix(c(0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1,                         0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1),                       nrow=4, byrow=TRUE)  prior <- c(0.5,0.5) wmk <- matrix(c(0.45,0.45,0.05,0.05,0.05,0.05,0.45,0.45),               ncol=4, nrow=2, byrow=TRUE) wkm <- apply(wmk*prior, 2, function(x) x/sum(x))  # generation of training data data_temp <- poLCA.simdata(N = 1000, probs = probs1,                            nclass = 2, ndv = 4, nresp = 4,                            P=rep(0.25,4)) data <- data_temp$dat lclass <- data_temp$trueclass grouping <- numeric() for (i in 1:length(lclass)) { grouping[i] <- sample(c(1,2),1, prob=wkm[,lclass[i]]) }  # generation of test data data_temp <- poLCA.simdata(N = 500, probs = probs1,                            nclass = 2, ndv = 4, nresp = 4,                            P=rep(0.25,4)) data.test <- data_temp$dat lclass <- data_temp$trueclass grouping.test <- numeric() for (i in 1:length(lclass)) { grouping.test[i] <- sample(c(1,2),1, prob=wkm[,lclass[i]]) }  # cclcda2-procedure object <- cclcda2(data, grouping, m=4) pred <- predict(object, data.test)$class 1-(sum(pred==grouping.test)/500) #> [1] 0.176"},{"path":"https://mchlbckr.github.io/lcda/reference/predict.lcda.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method for Latent Class Discriminant Analysis (LCDA) — predict.lcda","title":"Predict method for Latent Class Discriminant Analysis (LCDA) — predict.lcda","text":"Classifies new observations using parameters determined lcda-function.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.lcda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method for Latent Class Discriminant Analysis (LCDA) — predict.lcda","text":"","code":"# S3 method for class 'lcda' predict(object, newdata, ...)"},{"path":"https://mchlbckr.github.io/lcda/reference/predict.lcda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method for Latent Class Discriminant Analysis (LCDA) — predict.lcda","text":"object Object class lcda2. newdata Data frame cases classified. ... arguments ignored.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.lcda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict method for Latent Class Discriminant Analysis (LCDA) — predict.lcda","text":"Posterior probabilities new observations using parameters determined lcda-function computed. classification new data done Bayes decision function.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.lcda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict method for Latent Class Discriminant Analysis (LCDA) — predict.lcda","text":"list components: class Vector (class factor) classifications. posterior Posterior probabilities classes.     details computation see lcda.","code":""},{"path":"https://mchlbckr.github.io/lcda/reference/predict.lcda.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Predict method for Latent Class Discriminant Analysis (LCDA) — predict.lcda","text":"Michael B\\\"ucker","code":""},{"path":[]},{"path":"https://mchlbckr.github.io/lcda/reference/predict.lcda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict method for Latent Class Discriminant Analysis (LCDA) — predict.lcda","text":"","code":"# response probabilites for class 1 probs1 <- list() probs1[[1]] <- matrix(c(0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1),                        nrow=2, byrow=TRUE) probs1[[2]] <- matrix(c(0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1),                       nrow=2, byrow=TRUE) probs1[[3]] <- matrix(c(0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7),                       nrow=2, byrow=TRUE) probs1[[4]] <- matrix(c(0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1),                       nrow=2, byrow=TRUE)  # response probabilites for class 2 probs2 <- list() probs2[[1]] <- matrix(c(0.1,0.1,0.7,0.1,0.1,0.1,0.1,0.7),                       nrow=2, byrow=TRUE) probs2[[2]] <- matrix(c(0.1,0.1,0.1,0.7,0.7,0.1,0.1,0.1),                       nrow=2, byrow=TRUE) probs2[[3]] <- matrix(c(0.7,0.1,0.1,0.1,0.1,0.7,0.1,0.1),                       nrow=2, byrow=TRUE) probs2[[4]] <- matrix(c(0.1,0.7,0.1,0.1,0.1,0.1,0.7,0.1),                       nrow=2, byrow=TRUE)  # generation of data simdata1 <- poLCA.simdata(N = 500, probs = probs1, nclass = 2,               ndv = 4, nresp = 4, missval = FALSE)  simdata2 <- poLCA.simdata(N = 500, probs = probs2, nclass = 2,               ndv = 4, nresp = 4, missval = FALSE)  data1 <- simdata1$dat data2 <- simdata2$dat  data <- cbind(rbind(data1, data2), rep(c(1,2), each=500)) names(data)[5] <- \"grouping\" data <- data[sample(1:1000),] grouping <- data[[5]] data <- data[,1:4]  # lcda-procedure object <- lcda(data, grouping=grouping, m=2) pred.class <- predict(object, newdata=data)$class sum(pred.class==grouping)/length(pred.class) #> [1] 0.928"}]
